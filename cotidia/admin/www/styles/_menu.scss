
$menu_sidebar_width: $menu-width;
$menu_subnav_min_width: 180px;
$menu_header_height: 4rem;

$menu_background_color: #00213E;
$menu_background_color_mobile: #00213E;
$menu_home_background_color: #00213E;
$menu_border_color: $grey--medium;
$menu_link_color: $grey--light;
$menu_link_color_hover: #fff;
$menu_link_background_color: transparent;
$menu_link_background_color_hover: lighten(#00213E, 12%);
$menu_link_background_color_hover_mobile: transparent;
$menu_link_background_color_active: lighten(#00213E, 6%);
$menu_link_background_color_active_mobile: lighten(#00213E, 6%);
$menu_background_color_section: desaturate(lighten($menu_background_color, 30%), 30%);

// New //
.menu-header,
.menu-footer {
    align-items: center;
    color: #fff;
    display: flex;
    justify-content: space-between;
    padding: 1rem;
    width: $menu_sidebar_width;
}

.menu-header {
    border-bottom: 1px solid $menu_border_color;

    @media screen and (min-width: $laptop-width) {
        position: fixed;
        top: 0;
    }

    &__logo {
        height: auto;
        max-height: 2rem;
        max-width: $menu_sidebar_width * 0.5;
        width: auto;
    }
}

.menu-footer {
    border-top: 1px solid $menu_border_color;
    display: none;

    @media screen and (min-width: $laptop-width) {
        bottom: 0;
        display: flex;
        left: 0;
        position: fixed;
        right: 0;
        width: $menu_sidebar_width;
    }

    &__text {
        @include font-size($font_size--small);
    }

    &__list {
        padding-left: 0;
    }
}


body {
    &.menu--sidebar {
        .menu-item {
            float: none;
            font-size: 90%;

            &:hover {
                background: none;
            }

            &__link {
                align-items: center;
                display: flex;
                justify-content: flex-start;
                padding: 0.75rem 1rem;
                transition:
                    background $animation-speed--fast ease,
                    color $animation-speed--fast ease;

                &:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: $menu_link_color_hover;
                }
            }

            &__link-icon {
                align-items: center;
                display: flex;
                height: 1rem;
                justify-content: center;
                margin-right: $horizontal_padding;
                width: 1rem;
            }
        }
    }

    // Collapse
    &.menu--sidebar-collapse {
        @media screen and (min-width: $laptop-width) {
            .menu {
                &__header {
                    height: auto;
                }

                &__container {
                    padding-top: 0 !important;
                }
            }

            .menu-header,
            .menu-footer {
                padding: 0;
                width: $toolbar_height;
            }

            .menu-header {
                padding: 0;
                position: relative;

                &__logo {
                    display: none;
                }
            }

            .menu {
                width: $toolbar_height;
            }

            .menu-category {
                &__title,
                &__subtitle {
                    display: none;
                }

                &__toggle {
                    text-align: center;
                }

                &__close-icon {
                    display: none;
                }
            }

            .menu-item {
                &__link {
                    justify-content: center;
                    width: $toolbar_height;
                }

                &__link-icon {
                    margin-right: 0;
                }

                &__link-text {
                    display: none;
                }

                &__link--drop-arrow:after {
                    content: none;
                }

                &--home {
                    width: $toolbar_height;

                    .menu-item__link-icon {
                        display: block;
                    }
                }
            }

            .menu__item {
                &--sidebar-collapse {
                    display: none;
                    width: $toolbar_height;
                }
                &--sidebar-expand {
                    display: block;
                    width: $toolbar_height;
                }
            }

            .menu-footer {
                position: relative;
                width: $toolbar_height;

                &__text {
                    display: none;
                }
            }
        }
    }

    // Not collapse
    &:not(.menu--sidebar-collapse) {
        @media screen and (min-width: $laptop-width) {
            .menu {
                height: 100%;
                left: 0;
                padding-bottom: $toolbar_height;
                position: fixed;
                top: 0;
                transition: width $animation-speed ease;
                width: $menu_sidebar_width;
                z-index: 2;

                &__header {
                    height: $menu_header_height;
                }

                &__footer {
                    height: $content-foot-height;
                }

                &__container {
                    padding-top: $menu_header_height !important;
                }

                &__item {
                    &--sidebar-collapse {
                        display: block;
                    }

                    &--sidebar-expand {
                        display: none;
                    }
                }
            }

            .menu-category {
                min-height: 4rem;

                &__summary-icon {
                    display: none;
                }
            }
        }

        .menu-header,
        .menu-footer {
            .menu-item__link {
                padding: 0.5rem;

                &:hover {
                    background: transparent;
                }
            }
        }
    }
}

.menu-category {
    display: block;
    border-bottom: 1px solid $menu_border_color;
    transition: background $animation-speed ease;

    &:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    &--open,
    &--open:hover {
        background: rgba(0, 0, 0, 0.1);
    }


    &__toggle {
        background: none;
        border: none;
        color: #fff;
        display: block;
        cursor: pointer;
        font: inherit;
        outline: none; // TODO
        padding: 0.667rem 1rem;
        text-align: left;
        width: 100%;
    }

    &__title,
    &__subtitle {
        display: block;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    &__subtitle {
        @include font-size($font_size--small);

        color: $grey;
        opacity: 1;
        transition: opacity 0.25s ease 0.5s;
        position: absolute;
        width: calc(100% - (1rem * 2));

        .menu-category--open & {
            opacity: 0;
            transition: none;
        }
    }

    &__close-icon {
        float: right;
        opacity: 0;
        transform: rotate(0deg);
        transition:
            opacity $animation-speed--slow ease,
            transform $animation-speed ease;

        .menu-category--open > .menu-category__toggle:hover & {
            opacity: 1;
        }

        .menu-category--open & {
            transform: rotate(180deg);
        }
    }

    &__list {
        max-height: 0px;
        overflow: hidden;
        padding-left: 0;
        transition: max-height 0.75s ease;

        .menu-category--open & {
            max-height: 500px;
        }
    }
}

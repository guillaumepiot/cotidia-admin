<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Cotidia Admin Search Dashboard</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="http://localhost:8000/static/css/admin.css">
    </head>
    <body class="menu--sidebar">
        <menu class="menu">
            <header class="menu__item menu__item--open menu-item">
                <a href="#" class="menu-item__link"><span class="fa fa-bars"></span></a>
                <span class="menu__title">Admin</span>
            </header>
            <ul class="menu__container">
                <li class="menu__item menu__item--close menu-item">
                    <a href="#" class="menu-item__link"><span class="fa fa-close"></span></a>
                </li>
                <li class="menu__item menu-item menu-item--home">
                    <a href="#" class="menu-item__link">
                        <span class="menu-item__link-icon">
                            <span class="fa fa-home"></span>
                        </span>
                        <span class="menu-item__link-text">Admin</span>
                    </a>
                </li>

                <div class="menu__section">
                    Some section
                </div>

                <li class="menu__item menu-item">
                    <a href="#" class="menu-item__link"><span class="menu-item__link-icon"><span class="fa fa-users"></span></span> <span class="menu-item__link-text">First thing</span></a>
                </li>

                <li class="menu__item menu-item">
                    <a href="#" class="menu-item__link"><span class="menu-item__link-icon"><span class="fa fa-list"></span></span> <span class="menu-item__link-text">Next one</span></a>
                </li>

                <li class="menu__item menu-item">
                    <a href="#" class="menu-item__link"><span class="menu-item__link-icon"><span class="fa fa-users"></span></span> <span class="menu-item__link-text">Third</span></a>
                </li>

                <li class="menu__item menu-item">
                    <a href="#" class="menu-item__link"><span class="menu-item__link-icon"><span class="fa fa-calendar"></span></span> <span class="menu-item__link-text">And the last one</span></a>
                </li>
            </ul>
        </menu>

        <div class="toolbar">
            <a href="#" class="btn btn--create btn--small pull-right">
                <span class="fa fa-plus"></span>
                Add Person
            </a>
            <span class="toolbar__title">People</span>
        </div>

        <div class="content" id="search-dashboard">
            <form action="" method="get" class="head-bar head-bar--filter">
                <div class="form__group">
                    <label class="form__label">Search</label>
                    <div class="form__control">
                        <input type="text" />
                    </div>
                </div>
                <input type="submit" value="Filter" class="btn btn--primary btn--transparent" />
                <a href="" class="btn btn--transparent" title="Reset filters"><span class="fa fa-refresh"></span></a>
            </form>
        </div>

        <script src="search-dashboard.js"></script>
        <script>
            var onSuccess = function () {
                console.log('pOsting message')
                window.postMessage({
                    target: 'SearchDashboard',
                    endpoint: 'http://localhost:8000/api/generic/list/lender/product',
                    action: 'refresh',
                }, location.origin)
            }

            var onError = function (error) {
                alert('An error occurred while processing the request. The response from the server was:\n\n' + error)
            }

            var appConfig = {
                authToken: '8061585f768c98b4cc430de75115102101863ce7',
                endpoint: 'http://localhost:8000/api/generic/list/lender/product',
                detailURL: 'http://localhost:8000/admin/lender/product/:id',
                defaultColumns: [
                    'lender__company', 'loan_type', 'asset_type', 'security_type__name', 'max_ltv',
                    'max_ltc', 'min_loan', 'max_loan', 'min_term', 'min_term_type', 'max_term',
                    'max_term_type', 'arrangement_fee', 'procuration_fee', 'rate_type', 'min_rate',
                    'min_rate_tracking_type', 'max_rate', 'max_rate_tracking_type', 'exit_value',
                    'exit_type', 'profile__user__first_name', 'profile__user__last_name',
                    'profile__user__email', 'profile__mobile_number', 'profile__phone_number',
                ],
                batchActions: [
                    {
                        action: 'add_products',
                        label: 'Add products',
                        endpoint: 'http://localhost:8000/api/admin/invest/1/add_products',
                        onSuccess: onSuccess,
                        onError: onError,
                    },
                ],
                columns: {
                    id: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Id',
                    },
                    lender__company: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Company',
                    },
                    security_type__name: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Security Type',
                    },
                    loan_type: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Loan Type',
                        naming_field: 'name',
                        many: 'True',
                    },
                    asset_type: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Asset Type',
                        naming_field: 'name',
                        many: 'True',
                    },
                    profile__user__first_name: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'First Name',
                    },
                    profile__user__last_name: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Last Name',
                    },
                    profile__user__email: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Email',
                    },
                    profile__mobile_number: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Mobile Number',
                    },
                    profile__phone_number: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Phone Number',
                    },
                    uuid: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Uuid',
                    },
                    created_at: {
                        display: 'datetime',
                        filter: 'date',
                        label: 'Created At',
                    },
                    modified_at: {
                        display: 'datetime',
                        filter: 'date',
                        label: 'Modified At',
                    },
                    max_ltc: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Max LTC',
                    },
                    max_ltv: {
                        display: 'verbatim',
                        filter: 'text',
                        label: 'Max LTV',
                    },
                    min_loan: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Min Loan',
                    },
                    max_loan: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Max Loan',
                    },
                    arrangement_fee: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Arrangement Fee',
                    },
                    procuration_fee: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Procuration Fee',
                    },
                    rate_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Rate Type',
                        options: [
                            {
                                value: 'FIXED',
                                label: 'Fixed rate',
                            },
                            {
                                value: 'TRACKING',
                                label: 'Tracking rate',
                            },
                        ],
                    },
                    min_rate: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Min Rate',
                    },
                    min_rate_tracking_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Min Rate Tracking Type',
                        options: [
                            {
                                value: 'BASE',
                                label: 'Base rate',
                            },
                            {
                                value: '1M-LIBOR',
                                label: '1 month Libor',
                            },
                            {
                                value: '3M-LIBOR',
                                label: '3 month Libor',
                            },
                        ],
                    },
                    max_rate: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Max Rate',
                    },
                    max_rate_tracking_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Max Rate Tracking Type',
                        options: [
                            {
                                value: 'BASE',
                                label: 'Base rate',
                            },
                            {
                                value: '1M-LIBOR',
                                label: '1 month Libor',
                            },
                            {
                                value: '3M-LIBOR',
                                label: '3 month Libor',
                            },
                        ],
                    },
                    exit_value: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Exit Value',
                    },
                    exit_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Exit Type',
                        options: [
                            {
                                value: 'GDV',
                                label: 'GDV',
                            },
                            {
                                value: 'LOAN',
                                label: 'Loan',
                            },
                        ],
                    },
                    min_term: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Min Term',
                    },
                    min_term_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Min Term Type',
                        options: [
                            {
                                value: 'D',
                                label: 'Day',
                            },
                            {
                                value: 'M',
                                label: 'Month',
                            },
                            {
                                value: 'Y',
                                label: 'Year',
                            },
                        ],
                    },
                    max_term: {
                        display: 'verbatim',
                        filter: 'number',
                        label: 'Max Term',
                    },
                    max_term_type: {
                        display: 'verbatim',
                        filter: 'choice',
                        label: 'Max Term Type',
                        options: [
                            {
                                value: 'D',
                                label: 'Day',
                            },
                            {
                                value: 'M',
                                label: 'Month',
                            },
                            {
                                value: 'Y',
                                label: 'Year',
                            },
                        ],
                    },
                },
            }

            ReactDOM.render(React.createElement(window.SearchDashboard, appConfig), document.getElementById('search-dashboard'))
        </script>
    </body>
</html>
